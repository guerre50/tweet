(function(e){if(typeof define==="function"&&define.amd)define(["jquery"],e);else e(jQuery)})(function(e){e.fn.tweet=function(t){function i(e,t){if(typeof e==="string"){var n=e;for(var r in t){var i=t[r];n=n.split("{"+r+"}").join(i===null?"":i)}return n}else return e(t)}function s(t,n){return function(){var r=[];this.each(function(){r.push(this.replace(t,n))});return e(r)}}function o(e){return e.replace(/</g,"<").replace(/>/g,"^>")}function u(e,t){return e.replace(r,function(e){var n=/^[a-z]+:/i.test(e)?e:"http://"+e;var r=e;for(var i=0;i<t.length;++i){var s=t[i];if(s.url===n&&s.expanded_url){n=s.expanded_url;r=s.display_url;break}}return'<a href="'+o(n)+'">'+o(r)+"</a>"})}function a(e){return new Date(e)}function f(e){var t=function(e){return parseInt(e,10)};var n=new Date;var r=t((n.getTime()-e)/1e3);if(r<1)r=0;return{days:t(r/86400),hours:t(r/3600),minutes:t(r/60),seconds:t(r)}}function l(e){if(e.days>2)return"about "+e.days+" days ago";if(e.hours>24)return"about a day ago";if(e.hours>2)return"about "+e.hours+" hours ago";if(e.minutes>45)return"about an hour ago";if(e.minutes>2)return"about "+e.minutes+" minutes ago";if(e.seconds>1)return"about "+e.seconds+" seconds ago";return"just now"}function c(e){if(e.match(/^(@([A-Za-z0-9-_]+)) .*/i)){return n.auto_join_text_reply}else if(e.match(r)){return n.auto_join_text_url}else if(e.match(/^((\w+ed)|just) .*/im)){return n.auto_join_text_ed}else if(e.match(/^(\w*ing) .*/i)){return n.auto_join_text_ing}else{return n.auto_join_text_default}}function h(){var e=n.fetch===null?n.count:n.fetch;var t="&include_entities=1&callback=?";if(n.list){return n.twitter_api_proxy_url+"/1.1/lists/statuses.json?slug="+n.list+"&owner_screen_name="+n.username+"&page="+n.page+"&per_page="+e+t}else if(n.favorites){return n.twitter_api_proxy_url+"/1.1/favorites/list.json?screen_name="+n.username[0]+"&page="+n.page+"&count="+e+t}else if(n.query===null&&n.username.length===1){return n.twitter_api_proxy_url+"/1.1/statuses/user_timeline.json?screen_name="+n.username[0]+"&count="+e+(n.retweets?"&include_rts=1":"")+"&page="+n.page+t}else{var r=n.query||"from:"+n.username.join(" OR from:");return n.twitter_api_proxy_url+"/1.1/search/tweets.json?q="+encodeURIComponent(r)+t}}function p(e,t){if(t){return"user"in e?e.user.profile_image_url_https:p(e,false).replace(/^http:\/\/[a-z0-9]{1,3}\.twimg\.com\//,"https://s3.amazonaws.com/twitter_production/")}else{return e.profile_image_url||e.user.profile_image_url}}function d(t){var n=e(t);var r=n.select("img");var i=e(n.children()[0]).attr("aria-label");var s=i.indexOf(" (screen name: ");var o=new Date(r[2].innerHTML);var u=e(n.select("a")[1]).children();var a=n.attr("data-pic-twitter");var f=n.attr("data-tweet-id");var l={tweet_id:f,retweet:false,text:r[1].innerText.substr(0,140),created_at:o,user:{profile_image_url_https:e(e(r[0]).children()[0]).children()[0].src,profile_image_url:e(e(r[0]).children()[0]).children()[0].src,screen_name:i.substr(s+" (screen name: ".length).slice(0,-1),name:i.substr(0,s)}};return v(l)}function v(t){var r={};r.item=t;r.source=t.source;r.screen_name=t.from_user||t.user.screen_name;r.name=t.from_user_name||t.user.name;r.retweet=typeof t.retweeted_status!="undefined";r.tweet_time=a(t.created_at);r.join_text=n.join_text==="auto"?c(t.text):n.join_text;r.tweet_id=t.id_str;r.twitter_base="http://"+n.twitter_url+"/";r.user_url=r.twitter_base+r.screen_name;r.tweet_url=r.user_url+"/status/"+r.tweet_id;r.reply_url=r.twitter_base+"intent/tweet?in_reply_to="+r.tweet_id;r.retweet_url=r.twitter_base+"intent/retweet?tweet_id="+r.tweet_id;r.favorite_url=r.twitter_base+"intent/favorite?tweet_id="+r.tweet_id;r.retweeted_screen_name=r.retweet&&t.retweeted_status.user.screen_name;r.tweet_relative_time=l(f(r.tweet_time));r.entities=t.entities?(t.entities.urls||[]).concat(t.entities.media||[]):[];r.tweet_raw_text=r.retweet?"RT @"+r.retweeted_screen_name+" "+t.retweeted_status.text:t.text;r.tweet_text=e([u(r.tweet_raw_text,r.entities)]).linkUser().linkHash()[0];r.retweeted_tweet_text=e([u(t.text,r.entities)]).linkUser().linkHash()[0];r.tweet_text_fancy=e([r.tweet_text]).makeHeart()[0];r.avatar_size=n.avatar_size;r.avatar_url=p(r.retweet?t.retweeted_status:t,document.location.protocol==="https:");r.avatar_screen_name=r.retweet?r.retweeted_screen_name:r.screen_name;r.avatar_profile_url=r.twitter_base+r.avatar_screen_name;r.user=i('<a class="tweet_user" href="{user_url}">{screen_name}</a>',r);r.join=n.join_text?i('<span class="tweet_join">{join_text}</span>',r):"";r.avatar=r.avatar_size?i('<a class="tweet_avatar" href="{avatar_profile_url}"><img src="{avatar_url}" height="{avatar_size}" width="{avatar_size}" alt="{avatar_screen_name}\'s avatar" title="{avatar_screen_name}\'s avatar" border="0"/></a>',r):"";r.time=i('<span class="tweet_time"><a href="{tweet_url}" title="view tweet on twitter">{tweet_relative_time}</a></span>',r);r.text=i('<span class="tweet_text">{tweet_text_fancy}</span>',r);r.retweeted_text=i('<span class="tweet_text">{retweeted_tweet_text}</span>',r);r.reply_action=i('<a class="tweet_action tweet_reply" href="{reply_url}">reply</a>',r);r.retweet_action=i('<a class="tweet_action tweet_retweet" href="{retweet_url}">retweet</a>',r);r.favorite_action=i('<a class="tweet_action tweet_favorite" href="{favorite_url}">favorite</a>',r);return r}function m(t,r){var s=e('<ul class="tweet_list">');s.append(e.map(r,function(e){return"<li>"+i(n.template,e)+"</li>"}).join("")).children("li:first").addClass("tweet_first").end().children("li:odd").addClass("tweet_even").end().children("li:even").addClass("tweet_odd");e(t).empty().append(s);if(n.intro_text)s.before('<p class="tweet_intro">'+n.intro_text+"</p>");if(n.outro_text)s.after('<p class="tweet_outro">'+n.outro_text+"</p>");e(t).trigger("loaded").trigger(r.length===0?"empty":"full");if(n.refresh_interval){window.setTimeout(function(){e(t).trigger("tweet:load")},1e3*n.refresh_interval)}}function g(t){var r=e('<p class="loading">'+n.loading_text+"</p>");n.widget=t;n.$widget=e(t);if(n.loading_text)n.$widget.not(":has(.tweet_list)").empty().append(r);twitterFetcher.fetch(n.widget_id,"",n.tweets,true,true,true,y,false,b,false)}function y(e){return e}function b(t){var r=e.map(t.statuses||t,d);r=e.grep(r,n.filter).sort(n.comparator).slice(0,n.count);n.$widget.trigger("tweet:retrieved",[r])}var n=e.extend({twitter_api_proxy_url:null,username:null,widget_id:null,list:null,favorites:false,query:null,avatar_size:null,count:3,fetch:null,page:1,retweets:true,intro_text:null,outro_text:null,join_text:null,auto_join_text_default:" I said, ",auto_join_text_ed:" I ",auto_join_text_ing:" I am ",auto_join_text_reply:" I replied to ",auto_join_text_url:" I was looking at ",loading_text:null,refresh_interval:null,twitter_url:"twitter.com",template:"{avatar}{time}{join} {text}",comparator:function(e,t){return t.tweet_time-e.tweet_time},filter:function(e){return true}},t);var r=/\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi;e.extend({tweet:{t:i}});e.fn.extend({linkUser:s(/(^|[\W])@(\w+)/gi,'$1<span class="at">@</span><a href="http://'+n.twitter_url+'/$2">$2</a>'),linkHash:s(/(?:^| )[\#]+([\w\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0600-\u06ff]+)/gi,' <a href="https://'+n.twitter_url+"/search?q=%23$1&src=hash&lang=all"+(n.username&&n.username.length===1&&!n.list?"&from="+n.username.join("%2BOR%2B"):"")+'" class="tweet_hashtag">#$1</a>'),makeHeart:s(/(<)+[3]/gi,"<tt class='heart'>&#x2665;</tt>")});return this.each(function(t,r){if(n.username&&typeof n.username==="string"){n.username=[n.username]}e(r).unbind("tweet:render").unbind("tweet:retrieved").unbind("tweet:load").bind({"tweet:load":function(){g(r)},"tweet:retrieved":function(t,n){e(r).trigger("tweet:render",[n])},"tweet:render":function(t,n){m(e(r),n)}}).trigger("tweet:load")})}});var twitterFetcher=function(){function e(e){return e.replace(/<b[^>]*>(.*?)<\/b>/gi,function(e,t){return t}).replace(/class=".*?"|data-query-source=".*?"|dir=".*?"|rel=".*?"/gi,"")}function t(e,t){for(var n=[],r=RegExp("(^| )"+t+"( |$)"),i=e.getElementsByTagName("*"),s=0,o=i.length;s<o;s++)r.test(i[s].className)&&n.push(i[s]);return n}var n="",r=20,i=!0,s=[],o=!1,u=!0,a=!0,f=null,l=!0,c=!0,h=null,p=!0;return{fetch:function(e,t,l,d,v,m,g,b,E,S){void 0===l&&(l=20);void 0===d&&(i=!0);void 0===v&&(v=!0);void 0===m&&(m=!0);void 0===g&&(g="default");void 0===b&&(b=!0);void 0===E&&(E=null);void 0===S&&(S=!0);o?s.push({id:e,domId:t,maxTweets:l,enableLinks:d,showUser:v,showTime:m,dateFunction:g,showRt:b,customCallback:E,showInteraction:S}):(o=!0,n=t,r=l,i=d,a=v,u=m,c=b,f=g,h=E,p=S,t=document.createElement("script"),t.type="text/javascript",t.src="//cdn.syndication.twimg.com/widgets/timelines/"+e+"?&lang=en&callback=twitterFetcher.callback&suppress_response_codes=true&rnd="+Math.random(),document.getElementsByTagName("head")[0].appendChild(t))},callback:function(d){var m=document.createElement("div");m.innerHTML=d.body;"undefined"===typeof m.getElementsByClassName&&(l=!1);d=[];var g=[],b=[],E=[],S=[],T=[],N=[],C=0;if(l)for(m=m.getElementsByClassName("tweet");C<m.length;){0<m[C].getElementsByClassName("retweet-credit").length?E.push(!0):E.push(!1);if(!E[C]||E[C]&&c)d.push(m[C].getElementsByClassName("e-entry-title")[0]),S.push(m[C].getAttribute("data-tweet-id")),g.push(m[C].getElementsByClassName("p-author")[0]),b.push(m[C].getElementsByClassName("dt-updated")[0]),T.push(m[C].getElementsByClassName("autosized-media").length>0?m[C].getElementsByClassName("autosized-media")[0].getAttribute("src"):"");C++}else for(m=t(m,"tweet");C<m.length;)d.push(t(m[C],"e-entry-title")[0]),S.push(m[C].getAttribute("data-tweet-id")),g.push(t(m[C],"p-author")[0]),b.push(t(m[C],"dt-updated")[0]),0<t(m[C],"retweet-credit").length?E.push(!0):E.push(!1),T.push(m[C].getElementsByClassName("autosized-media").length>0?m[C].getElementsByClassName("autosized-media")[0].getAttribute("src"):""),C++;d.length>r&&(d.splice(r,d.length-r),g.splice(r,g.length-r),b.splice(r,b.length-r),E.splice(r,E.length-r));m=[];C=d.length;for(E=0;E<C;){if("string"!==typeof f){var L=new Date(b[E].getAttribute("datetime").replace(/-/g,"/").replace("T"," ").split("+")[0]),L=f(L);b[E].setAttribute("aria-label",L);if(d[E].innerText)if(l)b[E].innerText=L;else{var O=document.createElement("p"),M=document.createTextNode(L);O.appendChild(M);O.setAttribute("aria-label",L);b[E]=O}else b[E].textContent=L}L="";i?(a&&(L+='<div class="user" data-pic-twitter="'+T[E]+'" data-tweet-id="'+S[E]+'">'+e(g[E].innerHTML)+"</div>"),L+='<p class="tweet">'+e(d[E].innerHTML)+"</p>",u&&(L+='<p class="timePosted">'+b[E].getAttribute("aria-label")+"</p>")):d[E].innerText?(a&&(L+='<p class="user">'+g[E].innerText+"</p>"),L+='<p class="tweet">'+d[E].innerText+"</p>",u&&(L+='<p class="timePosted">'+b[E].innerText+"</p>")):(a&&(L+='<p class="user">'+g[E].textContent+"</p>"),L+='<p class="tweet">'+d[E].textContent+"</p>",u&&(L+='<p class="timePosted">'+b[E].textContent+"</p>"));p&&(L+='<p class="interact"><a href="https://twitter.com/intent/tweet?in_reply_to='+S[E]+'" class="twitter_reply_icon">Reply</a><a href="https://twitter.com/intent/retweet?tweet_id='+S[E]+'" class="twitter_retweet_icon">Retweet</a><a href="https://twitter.com/intent/favorite?tweet_id='+S[E]+'" class="twitter_fav_icon">Favorite</a></p>');m.push(L);E++}if(null==h){d=m.length;g=0;b=document.getElementById(n);for(S="<ul>";g<d;)S+="<li>"+m[g]+"</li>",g++;b.innerHTML=S+"</ul>"}else h(m);o=!1;0<s.length&&(twitterFetcher.fetch(s[0].id,s[0].domId,s[0].maxTweets,s[0].enableLinks,s[0].showUser,s[0].showTime,s[0].dateFunction,s[0].showRt,s[0].customCallback,s[0].showInteraction),s.splice(0,1))}}}()